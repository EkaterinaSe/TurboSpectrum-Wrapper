
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Code reference &#8212; TS-wrapper  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to TS-wrapper’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-model_atm_interpolation">
<span id="code-reference"></span><h1>Code reference<a class="headerlink" href="#module-model_atm_interpolation" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="model_atm_interpolation.NDinterpolateGrid">
<code class="sig-prename descclassname">model_atm_interpolation.</code><code class="sig-name descname">NDinterpolateGrid</code><span class="sig-paren">(</span><em class="sig-param">all_par</em>, <em class="sig-param">interpol_par</em>, <em class="sig-param">valueKey='structure'</em>, <em class="sig-param">dataLabel='model_atm'</em><span class="sig-paren">)</span><a class="headerlink" href="#model_atm_interpolation.NDinterpolateGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalise the coordinates of the grid</p>
</dd></dl>

<dl class="function">
<dt id="model_atm_interpolation.get_all_ma_parameters">
<code class="sig-prename descclassname">model_atm_interpolation.</code><code class="sig-name descname">get_all_ma_parameters</code><span class="sig-paren">(</span><em class="sig-param">models_path</em>, <em class="sig-param">depthScaleNew</em>, <em class="sig-param">format='m1d'</em>, <em class="sig-param">debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#model_atm_interpolation.get_all_ma_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a list of all available model atmopsheres and their parameters
for interpolation later on.
If no list is available, creates one by scanning through all available
models in the specified input directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>models_path</strong> (<em>str</em>) – input directory contatining all available model atmospheres</p></li>
<li><p><strong>depthScaleNew</strong> (<em>array</em>) – depth scale (e.g. TAU500nm) to be used uniformly for model
atmospheres and departure coefficients
required to ensure homogenious interpolation and can be provided
in the config file</p></li>
<li><p><strong>format</strong> (<em>str</em>) – format of model atmosphere, options: ‘m1d’ for MULTI formatted input,
‘marcs’ for standard MARCS format</p></li>
<li><p><strong>debug</strong> (<em>boolean</em>) – switch detailed print out</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>MAgrid</strong> – dictionary containing grid of model atmospheres including both
the parameters (like Teff, log(g), etc)
and structure (density as a function of depth, etc)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="model_atm_interpolation.preInterpolationTests">
<code class="sig-prename descclassname">model_atm_interpolation.</code><code class="sig-name descname">preInterpolationTests</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">interpol_coords</em>, <em class="sig-param">valueKey</em>, <em class="sig-param">dataLabel='default'</em><span class="sig-paren">)</span><a class="headerlink" href="#model_atm_interpolation.preInterpolationTests" title="Permalink to this definition">¶</a></dt>
<dd><p>Run multiple tests to catch possible exceptions
that could affect the performance of the underlying
Qnull math engine during Delaunay triangulation
:param data: input directory contatining all available model atmospheres
:type data: str
:param interpol_coords: depth scale (e.g. TAU500nm) to be used uniformly for model</p>
<blockquote>
<div><p>atmospheres and departure coefficients
required to ensure homogenious interpolation and can be provided
in the config file</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>valueKey</strong> (<em>str</em>) – format of model atmosphere, options: ‘m1d’ for MULTI formatted input,
‘marcs’ for standard MARCS format</p></li>
<li><p><strong>dataLabel</strong> (<em>boolean</em>) – switch detailed print out</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-read_nlte"></span><dl class="function">
<dt id="read_nlte.find_distance_to_point">
<code class="sig-prename descclassname">read_nlte.</code><code class="sig-name descname">find_distance_to_point</code><span class="sig-paren">(</span><em class="sig-param">point</em>, <em class="sig-param">grid</em><span class="sig-paren">)</span><a class="headerlink" href="#read_nlte.find_distance_to_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the closest record in the NLTE grid to the supplied point
based on quadratic distance.
If several records are at the same distance
(might happen if e.g. one abudnance was included twice),
the first one is picked</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point</strong> (<em>dict</em>) – coordinates of the input point. Only coordinates provided here will
be used to compute the distance</p></li>
<li><p><strong>grid</strong> (<em>dict</em>) – NLTE grid of departure coefficients as read by read_fullNLTE_grid()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pos</strong> (<em>int</em>) – position of the closest point found in the grid</p></li>
<li><p><strong>comment</strong> (<em>str</em>) – notifies if more than one point at the minimum distance was found
and which one was picked</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="read_nlte.read_binary_grid">
<code class="sig-prename descclassname">read_nlte.</code><code class="sig-name descname">read_binary_grid</code><span class="sig-paren">(</span><em class="sig-param">grid_file</em>, <em class="sig-param">pointer=1</em><span class="sig-paren">)</span><a class="headerlink" href="#read_nlte.read_binary_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a record at specified position from the binary NLTE grid
(grid of departure coefficients)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_file</strong> (<em>str</em>) – path to the binary NLTE grid</p></li>
<li><p><strong>pointer</strong> (<em>int</em>) – bitwise start of the record as read from the auxiliarly file</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ndep</strong> (<em>int</em>) – number of depth points in the model atmosphere used to solve for NLTE</p></li>
<li><p><strong>nk</strong> (<em>int</em>) – number of energy levels in the model atom used to solved for NLTE</p></li>
<li><p><strong>depart</strong> (<em>array</em>) – NLTE departure coefficients of shape (ndep, nk)</p></li>
<li><p><strong>tau</strong> (<em>array</em>) – depth scale (e.g. TAU500nm) in the model atmosphere
used to solve for NLTE of shape (ndep)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="read_nlte.read_departures_forTS">
<code class="sig-prename descclassname">read_nlte.</code><code class="sig-name descname">read_departures_forTS</code><span class="sig-paren">(</span><em class="sig-param">fileName</em><span class="sig-paren">)</span><a class="headerlink" href="#read_nlte.read_departures_forTS" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads NLTE departure coefficients from the input file compatible
with TurboSpectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fileName</strong> (<em>str</em>) – name of the file in which to write the departure coefficients</p></li>
<li><p><strong>tau</strong> (<em>np.array</em>) – depth scale (e.g. TAU500nm)</p></li>
<li><p><strong>depart</strong> (<em>np.ndarray</em>) – departure coefficients</p></li>
<li><p><strong>abund</strong> (<em>float</em>) – chemical element abundance</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>abund</strong> (<em>float</em>) – abundance of the chemical element on log 12 scale</p></li>
<li><p><strong>tau</strong> (<em>np.array</em>) – depth scale in the model atmosphere used to solve for NLTE RT
(e.g. TAU500nm)</p></li>
<li><p><strong>depart</strong> (<em>np.ndarray</em>) – departure coefficients</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="read_nlte.read_fullNLTE_grid">
<code class="sig-prename descclassname">read_nlte.</code><code class="sig-name descname">read_fullNLTE_grid</code><span class="sig-paren">(</span><em class="sig-param">bin_file</em>, <em class="sig-param">aux_file</em>, <em class="sig-param">rescale=False</em>, <em class="sig-param">depthScale=None</em>, <em class="sig-param">saveMemory=False</em><span class="sig-paren">)</span><a class="headerlink" href="#read_nlte.read_fullNLTE_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the full binary NLTE grid of departure coefficients
Note: binary grids can reach up to 100 Gb in size, therefore it is
possible to only read half of the records
randomly distributed across the grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bin_file</strong> (<em>str</em>) – path to the binary NLTE grid</p></li>
<li><p><strong>aux_file</strong> (<em>str</em>) – path to the complementary auxilarly file</p></li>
<li><p><strong>rescale</strong> (<em>boolean</em>) – whether or not to bring the departure coefficients onto a depth
scale different from the depth scale in the model atmosphere
used in solving for NLTE. False by default</p></li>
<li><p><strong>depthScale</strong> (<em>np.array</em>) – depth scale to which departure coefficients will be rescaled
if rescale is set to True</p></li>
<li><p><strong>saveMemory</strong> (<em>boolean</em>) – whether or not to save the memory by only reading random
half of the records in the NLTE grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> – contains NLTE departure coefficients as well as the depth scale of the
model atmosphere and parameters used in RT
(e.g. Teff, log(g) of model atmosphere)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="read_nlte.write_departures_forTS">
<code class="sig-prename descclassname">read_nlte.</code><code class="sig-name descname">write_departures_forTS</code><span class="sig-paren">(</span><em class="sig-param">fileName</em>, <em class="sig-param">tau</em>, <em class="sig-param">depart</em>, <em class="sig-param">abund</em><span class="sig-paren">)</span><a class="headerlink" href="#read_nlte.write_departures_forTS" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes NLTE departure coefficients into the file compatible
with TurboSpectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fileName</strong> (<em>str</em>) – name of the file in which to write the departure coefficients</p></li>
<li><p><strong>tau</strong> (<em>np.array</em>) – depth scale in the model atmosphere used to solve for NLTE RT
(e.g. TAU500nm)</p></li>
<li><p><strong>depart</strong> (<em>np.ndarray</em>) – departure coefficients</p></li>
<li><p><strong>abund</strong> (<em>float</em>) – chemical element abundance on log 12 scale</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-chemical_elements"></span><dl class="class">
<dt id="chemical_elements.ChemElement">
<em class="property">class </em><code class="sig-prename descclassname">chemical_elements.</code><code class="sig-name descname">ChemElement</code><span class="sig-paren">(</span><em class="sig-param">ID=''</em><span class="sig-paren">)</span><a class="headerlink" href="#chemical_elements.ChemElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for handling individual chemical elements. Gets atomic number
and checks whether element is Fe or H when initialised</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ID</strong> (<em>str</em>) – element name e.g. ‘Fe’</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="chemical_elements.atomicZ">
<code class="sig-prename descclassname">chemical_elements.</code><code class="sig-name descname">atomicZ</code><span class="sig-paren">(</span><em class="sig-param">el</em><span class="sig-paren">)</span><a class="headerlink" href="#chemical_elements.atomicZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds atomic number (Z) of the chemical element by comparing its name
to the list stored in ./atomic_numbers.dat</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>el</strong> (<em>str</em>) – element name e.g. ‘Mg’</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-generate_random_grid"></span><dl class="function">
<dt id="generate_random_grid.run_TS_parallel">
<code class="sig-prename descclassname">generate_random_grid.</code><code class="sig-name descname">run_TS_parallel</code><span class="sig-paren">(</span><em class="sig-param">set</em><span class="sig-paren">)</span><a class="headerlink" href="#generate_random_grid.run_TS_parallel" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits requested input parameters into N_CPU chunks and calls
parallel_worker N_CPU times in parallel with respective input</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>set</strong> (<em>setup</em>) – Configuration of requested computaions</p>
</dd>
</dl>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">TS-wrapper</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to TS-wrapper’s documentation!</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Ekaterina Magg.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/code.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>